{"version":3,"sources":["game.js"],"names":[],"mappings":"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","file":"game.es5.js","sourcesContent":["\nlet pro = 0;\nconst width = window.innerWidth;\nconst height = window.innerHeight;\nlet bgMusic;\n\nvar game = new Phaser.Game(width, height, Phaser.CANVAS, '#game');\n\nconst progressFn = (game) => {\n    let progressText = game.add.text(game.world.centerX, game.world.centerY, '0%', {\n        fontSize: '60px',\n        fill: '#fff',\n    });\n    let deadLine = false;\n    setTimeout(() => {\n        deadLine = true;\n    }, 3000);\n    progressText.anchor.setTo(0.5, 0.5);\n    const loadComplete = function() {\n        if (deadLine) {\n            game.state.start('created');\n        } else {\n            setTimeout(loadComplete, 1000);\n        }\n    };\n\n    const loading = (progress) => {\n        pro = progressText.text = progress + '%';\n    };\n\n    game.load.onFileComplete.add(loading);\n    game.load.onLoadComplete.add(loadComplete);\n}\n\nconst states = {\n    preload: function() {\n        this.preload = function() {\n\t\t\tgame.stage.backgroundColor = '#000';\n            game.load.crossOrigin = 'anonymous'; // 设置跨域\n            game.load.image('bg', './img/bg.png');\n            game.load.image('dude', './img/dude.png');\n            game.load.image('green', './img/green.png');\n            game.load.image('red', './img/red.png');\n            game.load.image('yellow', './img/yellow.png');\n            game.load.image('bomb', './img/bomb.png');\n            game.load.image('five', './img/five.png');\n            game.load.image('three', './img/three.png');\n            game.load.image('one', './img/one.png');\n            game.load.audio('bgMusic', './audio/bgm.mp3');\n            progressFn(game);\n        }\n    },\n    created: function() {\n        this.create = function() {\n            // 添加背景\n            let bg = game.add.image(0, 0, 'bg');\n            bg.width = game.world.width;\n            bg.height = game.world.height;\n            // 添加标题\n            const title = game.add.text(game.world.centerX, game.world.centerY * 0.25, '小恐龙接苹果', {\n                fontSize: '40px',\n                fontWeight: 'blod',\n                fill: '#f2bb15',\n            });\n            title.anchor.setTo(0.5, 0.5);\n            // 添加提示\n            const remind = game.add.text(game.world.centerX, game.world.centerY * 0.5, '点击任意位置开始', {\n                fontSize: '20px',\n                fill: '#f2bb15'\n            });\n            remind.anchor.setTo(0.5, 0.5);\n            // 添加主角\n            const man = game.add.sprite(game.world.centerX, game.world.height * 0.75, 'dude');\n            const manImage = game.cache.getImage('dude');\n            man.width = game.world.width * 0.2;\n            man.height = man.width / manImage.width * manImage.height;\n            man.anchor.setTo(0.5, 0.5);\n            // 添加点击事件\n            game.input.onTap.add(() => {\n                game.state.start('play');\n            });\n        };\n    },\n    play: function() {\n        let title;\n        let man;\n        let apples;\n        let score = 0;\n        this.create = function() {\n\t\t\t// 添加背景\n            var bg = game.add.image(0, 0, 'bg');\n            bg.width = game.world.width;\n            bg.height = game.world.height;\n            // 添加主角\n            man = game.add.sprite(game.world.centerX, game.world.height * 0.75, 'dude');\n            var manImage = game.cache.getImage('dude');\n            man.width = game.world.width * 0.2;\n            man.height = man.width / manImage.width * manImage.height;\n            man.anchor.setTo(0.5, 0.5);\n            game.physics.enable(man); // 加入物理运动\n            man.body.allowGravity = false; // 清除重力影响\n            // 添加分数\n            score = 0;\n            title = game.add.text(game.world.centerX, game.world.height * 0.25, score, {\n                fontSize: '40px',\n                fontWeight: 'bold',\n                fill: '#f2bb15'\n            });\n            title.anchor.setTo(0.5, 0.5);\n            // 播放背景音乐\n            bgMusic = game.add.audio('bgMusic');\n            bgMusic.loopFull();\n            const scoreMusic = game.add.audio('scoreMusic');\n            const bombMusic = game.add.audio('bombMusic');\n            // 添加苹果\n            apples = game.add.group();\n            const appleTypes = ['green', 'red', 'yellow', 'bomb'];\n            const appleTime = game.time.create(true);\n            appleTime.loop(500, () => {\n                const x = Math.random() * game.world.width;\n                const y = 0;\n                const type = appleTypes[Math.floor(Math.random() * appleTypes.length)];\n                // console.log(x, y, type);\n                const apple = apples.create(x, y, type);\n                // 设置苹果加入物理运动\n                game.physics.enable(apple);\n                // 设置苹果大小\n                const appleImg = game.cache.getImage(type);\n                apple.width = game.world.width / 8;\n                apple.height = apple.width / appleImg.width * appleImg.height;\n                // 掉落物设置和边界接触\n                apple.body.collideWorldBounds = true;\n                apple.body.onWorldBounds = new Phaser.Signal();\n                apple.body.onWorldBounds.add(function(apple, up, down, left, right) {\n                    if (down) {\n                        apple.kill();\n                        if (apple.key === 'bomb') return;\n                        game.state.start('over', true, false, score);\n                    }\n                });\n            });\n            appleTime.start();\n            // 开启物理引擎\n            game.physics.startSystem(Phaser.Physics.Arcade);\n            game.physics.arcade.gravity.y = 300;            \n            // 监听滑动事件\n            let touching = false;\n            let dx;\n            game.input.onDown.add((pointer) => {\n                if (Math.abs(pointer.x - man.x) < man.width / 2) {\n                    touching = true;\n                    dx = man.x - pointer.x;\n                }\n            });\n            game.input.onUp.add(() => {\n                touching = false;\n            });\n            game.input.addMoveCallback((pointer, x ,y, isTap) => {\n                // console.log(x, y);\n                if (!isTap && touching) man.x = x + dx;\n            });\n        }\n        this.update = function() {\n            // 检测主角和掉落物的碰撞\n            game.physics.arcade.overlap(man, apples, pickApple, null, this);\n        }\n        const pickApple = function(man, apple) {\n            var point = 1;\n            var img = 'one';\n            if (apple.key === 'red') {\n                point = 3;\n                img = 'three';\n            } else if (apple.key === 'yellow') {\n                point = 5;\n                img = 'five';\n            } else if (apple.key === 'bomb') {\n                game.state.start('over', true, false, score);\n                return;\n            }\n            // 添加得分图片\n            var goal = game.add.image(apple.x, apple.y, img);\n            var goalImg = game.cache.getImage(img);\n            goal.width = apple.width;\n            goal.height = goal.width / (goalImg.width / goalImg.height);\n            goal.alpha = 0;\n\n            // 添加过渡效果\n            var showTween = game.add.tween(goal).to({\n                alpha: 1,\n                y: goal.y - 20\n            }, 100, Phaser.Easing.Linear.None, true, 0, 0, false);\n            showTween.onComplete.add(function() {\n                var hideTween = game.add.tween(goal).to({\n                    alpha: 0,\n                    y: goal.y - 20\n                }, 100, Phaser.Easing.Linear.None, true, 200, 0, false);\n                hideTween.onComplete.add(function() {\n                    goal.kill();\n                });\n            });\n            \n            title.text = +score + point;\n            score = title.text;\n            apple.kill();\n        }\n    },\n    over: function() {\n        this.init = function() {\n            score = arguments[0];\n        }\n        this.create = function() {\n            game.stage.backgroundColor = '#000';\n            // 添加文本\n            const title = game.add.text(game.world.centerX, game.world.centerY * 0.25, '游戏结束',{\n                fontSize: '40px',\n                fontWeight: 'bold',\n                fill: '#f2bb15'\n            });\n            title.anchor.setTo(0.5, 0.5);\n            const scoreStr = '你的得分是：'+ score +'分 我姐好厉害么么哒';\n            const scoreText = game.add.text(game.world.centerX, game.world.height * 0.4, scoreStr, {\n                fontSize: '30px',\n                fontWeight: 'bold',\n                fill: '#f2bb15'\n            });\n            scoreText.anchor.setTo(0.5, 0.5);\n            const remind = game.add.text(game.world.centerX, game.world.height * 0.6, '点击任意位置再玩一次', {\n                fontSize: '20px',\n                fontWeight: 'bold',\n                fill: '#f2bb15'\n            });\n            remind.anchor.setTo(0.5, 0.5);\n            // 添加点击事件\n            game.input.onTap.add(function() {\n                console.log(bgMusic);\n                bgMusic.stop();\n                game.state.start('play');\n            });\n        }\n    },\n};\n\n\nObject.keys(states).map(function(key) {\n\tgame.state.add(key, states[key]);\n});\n\n// 启动游戏\ngame.state.start('preload');\n\n\n"]}